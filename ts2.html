<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TS</title>
</head>
<body>
    <form id="searchForm" action="https://www.dial247.co.uk/CGI-BIN/LANSAWEB?WEBEVENT+L2D1FBF1023E9D701098C02Y+CEL+ENG" method="post">
        <input type="hidden" name="s" id="searchTerm">
    </form>

    <script>
        // Function to get the value of a query parameter by name
        function getQueryParam(param) {
            let urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Placeholder function to check if the user is logged in
        function isLoggedIn() {
            // This should return true if the user is logged in, false otherwise
            // Replace this with actual login check logic, e.g., checking a cookie or session
            return document.cookie.includes("loggedIn=true");
        }

        // Function to handle the search process
        function handleSearch() {
            let searchTerm = getQueryParam("search");
            
            if (searchTerm) {
                if (!isLoggedIn()) {
                    // If not logged in, redirect to login page with the current URL as a parameter
                    let currentUrl = window.location.href;
                    let loginUrl = "https://www.tohatsu.co.uk/DealerArea/login.php?redirect=" + encodeURIComponent(currentUrl);
                    window.location.href = loginUrl;
                } else {
                    // If already logged in, proceed with the search
                    document.getElementById("searchTerm").value = searchTerm;
                    document.getElementById("searchForm").submit();
                }
            }
        }

        document.addEventListener("DOMContentLoaded", handleSearch);
    </script>
</body>
</html>
